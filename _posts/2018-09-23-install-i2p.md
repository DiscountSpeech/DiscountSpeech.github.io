---
layout: post
title:  "Installing I2P Service"
date:   2018-09-23 12:01:00 -0500
# categories: jekyll update
---

The I2P service is pretty simple to install, simply use the `apt` repository

```
sudo apt-add-repository ppa:i2p-maintainers/i2p
sudo apt-get update
sudo apt-get install i2p
```

Once installed we can ensure it is running...
```
systemctl status i2p.service
```

Assuming that worked, first thing we will want to do is to familiarize ourselves with the router config.  The preferred way to do this is through the router console served on localhost.  Since our VM is tiny and we have not installed a desktop thus far, we will do this through lynx

```
http_proxy="http://127.0.0.1:4444" \
 no_proxy="127.0.0.1" \
 lynx \
 -accept_all_cookies \
 http://127.0.0.1:7657
```

First thing I did was to lower the bandwidth by a factor of 3.  Since GCE charges for `egress` (bytes in) you will want to keep track of this and not go overboard.  This can be done manually in `/var/lib/i2p/i2p-config/router.config`, or at the URI `http://127.0.0.1:7657`

Finally, once everything is set up, we can open up our incoming ports to participate fully in the network.  First determine what port to open
```
sudo grep -i port /var/lib/i2p/i2p-config/router.config
```

<!-- todo: figure out how to create a firewall rule in gcloud cmd -->

Now we need to create a firewall in GCP for our VM to use that port.

* Navigate to the [GCP Networking page](https://console.cloud.google.com/networking)
* Select "Firewall Rules"
* Select "Create Firewall Rule"
* Name "i2p-server"
* Target Tags "i2p-server"
* Source IP "0.0.0.0/0"
* UDP "{port}" (where port was found in the command above)
* Create

Once created you can add the tag to your server with the gcloud command
```
gcloud config set compute/zone {zone}
gcloud compute instances add-tags {vm-name} --tags "i2p-server"
```

Now you can restart i2p (may not be needed)
```
systemctl restart i2p.service
```